<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://unpkg.com/alpinejs" defer></script>
    <title>Document</title>
</head>
<body>
    <div x-data="{
                title: '',
                priority: 0,
                completed: false,
                output: 'before request',
                getPayload() {
                    return JSON.stringify({
                        title: this.title,
                        priority: this.priority,
                        completed: this.completed
                    })
                },
                async addTask() {
                    const response = await fetch('http://127.0.0.1:8000/test', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: this.getPayload()
                    });
                    const data = await response.json();
                    this.output = JSON.stringify(data);
                    console.log(data);
                }
            }">
            <div>
                <div
                    x-text="getPayload()"
                    style="margin-bottom: 1em; font-family: monospace;"
                ></div>
            </div>
                <form @submit.prevent="addTask()">
                    <input
                        type="text"
                        placeholder="Task title"
                        x-model="title"
                        name="title"
                        id=""
                    />
                    <input
                        type="number"
                        placeholder="Priority (number)"
                        x-model.number="priority"
                        name="priority"
                        id=""
                    />
                    <input
                        type="checkbox"
                        x-model="completed"
                        name="completed"
                        id=""
                    />
                    <button
                        type="submit"
                    >
                        Add Task
                    </button>
                </form>
            <div x-text="output"></div>
        </div>
</body>
</html>